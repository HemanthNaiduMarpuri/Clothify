{% extends "base.html" %}
{% load static %}

{% block title %}My Profile{% endblock %}

{% block content %}
<style>
    .profile-card {
        max-width: 800px;
        margin: auto;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .profile-header {
        padding: 40px 20px;
        text-align: center;
        color: white;
        position: relative;
    }

    .profile-header img {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 4px solid white;
        object-fit: cover;
    }

    .back-btn {
        position: absolute;
        top: 20px;
        left: 20px;
    }

    .edit-btn {
        margin-top: 15px;
        margin-bottom: 10px;
    }

    .profile-body {
        padding: 25px 30px;
    }

    .info-label {
        font-weight: 600;
        color: #666;
        font-size: 15px;
    }

    .info-value {
        font-size: 17px;
        font-weight: 500;
    }
</style>

<div class="profile-card">

    <div class="profile-header"
        {% if request.user.user_role == "customer" %}
            style="background: linear-gradient(135deg, #ff7b47, #ffb88c);"
        {% elif request.user.user_role == "delivery boy" %}
            style="background: linear-gradient(135deg, #28a745, #74e39f);"
        {% else %}
            style="background: linear-gradient(135deg, #1f1f1f, #3b3b3b);"
        {% endif %}
    >

        <a href="{% url 'homepage' %}" class="btn btn-light btn-sm back-btn">
            ‚Üê Back
        </a>
        {% if request.user.user_role == "customer" %}
            {% if request.user.customer_profile.image %}
                <img src="{{ request.user.customer_profile.image.url }}" class="img-fluid rounded">
            {% else %}
                <img src="{% static 'images/default_user.png' %}" class="img-fluid rounded">
            {% endif %}
        {% elif request.user.user_role == "delivery boy" %}
            {% if request.user.delivery_profile.image %}
                <img src="{{ request.user.delivery_profile.image.url }}" class="img-fluid rounded">
            {% else %}
                <img src="{% static 'images/default_user.png' %}" class="img-fluid rounded">
            {% endif %}
        {% else %}
            <img src="{% static 'images/default_user.png' %}" alt="">
        {% endif %}

        <h2 class="mt-3 fw-bold">{{ request.user.username }}</h2>

        <p class="mb-0">
            {% if request.user.user_role == 'customer' %}Customer Account{% endif %}
            {% if request.user.user_role == 'delivery boy' %}Delivery Partner{% endif %}
            {% if request.user.user_role == 'admin' %}Administrator{% endif %}
        </p>
        {% if request.user.user_role == 'delivery boy' %}
        <a href="{% url 'delivery_profile_edit' %}" class="btn btn-primary btn-sm edit-btn fw-semibold">Edit Profile</a>
        {% elif request.user.user_role == 'customer' %}
        <a href="{% url 'customer_profile_edit' %}" class="btn btn-primary btn-sm edit-btn fw-semibold">Edit Profile</a>
        {% endif %}
    </div>

    <div class="profile-body">

        {% if request.user.user_role == "customer" %}
            <div class="row mb-3">
                <div class="col-4 info-label">Email:</div>
                <div class="col-8 info-value">{{ request.user.email }}</div>
            </div>

            <div class="row mb-3">
                <div class="col-4 info-label">Contact:</div>
                <div class="col-8 info-value">{{ request.user.customer_profile.contact }}</div>
            </div>

            <div class="row mb-3">
                <div class="col-4 info-label">Address:</div>
                <div class="col-8 info-value">{{ request.user.customer_profile.address }}</div>
            </div>
        {% endif %}

        {% if request.user.user_role == "delivery boy" %}
            <div class="row mb-3">
                <div class="col-4 info-label">Email:</div>
                <div class="col-8 info-value">{{ request.user.email }}</div>
            </div>

            <div class="row mb-3">
                <div class="col-4 info-label">Contact:</div>
                <div class="col-8 info-value">{{ request.user.delivery_profile.contact }}</div>
            </div>

            <div class="row mb-3">
                <div class="col-4 info-label">Status:</div>
                <div class="col-8 info-value text-capitalize">{{ request.user.delivery_profile.status }}</div>
            </div>

            <div class="row mb-3">
                <div class="col-4 info-label">ID Proof:</div>
                <div class="col-8 info-value">{{ request.user.delivery_profile.idproof }}</div>
            </div>

            {% if request.user.delivery_profile.idproof_image %}
                <div class="mt-3">
                    <p class="fw-semibold">ID Proof Image:</p>
                    <img src="{{ request.user.delivery_profile.idproof_image.url }}" width="150">
                </div>
            {% endif %}
        {% endif %}

        {% if request.user.user_role == "admin" %}
            <p class="text-muted">Admin has no personal details stored.</p>
        {% endif %}

    </div>
</div>

{% endblock %}
